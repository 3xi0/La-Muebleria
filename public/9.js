(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{75:function(e,t,r){"use strict";r.r(t);var a=r(0),s=r.n(a);function o(e,t,r,a,s,o,i){try{var n=e[o](i),l=n.value}catch(e){return void r(e)}n.done?t(l):Promise.resolve(l).then(a,s)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(a,s){var i=e.apply(t,r);function n(e){o(i,a,s,n,l,"next",e)}function l(e){o(i,a,s,n,l,"throw",e)}n(void 0)}))}}var n,l,c={data:function(){return{submiting:!1,categories:[],form:{name:"",model:"",description:"",price:null,thumbnail:null,details:[],category:""},validationErrors:{name:[],model:[],description:[],price:[],thumbnail:[],details:[],category:[]},generalError:"",detailsC:null}},created:function(){this.fetchCategories()},watch:{$route:function(){this.submiting=!1,this.categories=[],this.form.name="",this.form.model="",this.form.description="",this.form.price=null,this.form.thumbnail=null,this.form.details=[],this.form.category="",this.validationErrors.name=[],this.validationErrors.model=[],this.validationErrors.description=[],this.validationErrors.price=[],this.validationErrors.thumbnail=[],this.validationErrors.details=[],this.validationErrors.category=[],this.generalError="",this.detailsC=null,this.fetchCategories()}},methods:{setDetailsImages:function(e){this.form.details=e,this.detailsC=_.map(e,this.getImage)},getImage:function(e){return URL.createObjectURL(e)},onlyNumbers:function(e){var t=(e=e||window.event).which?e.which:e.keyCode;if(!(t>31&&(t<48||t>57)&&46!==t))return!0;e.preventDefault()},fetchCategories:(l=i(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,axios.get("/api/categories/");case 3:this.categories=e.sent.data,e.next=11;break;case 6:e.prev=6,e.t0=e.catch(0),t="",e.t0.response?404==e.t0.response.status?t+="El recurso solicitado no existe":401!=e.t0.response.status&&403!=e.t0.response.status||(t+="No posee acceso al recurso solicitado"):t=e.t0.request?"El servidor tardó en responder":"No se pudo comunicar con el servidor",this.$notify({group:"messages",type:"error",title:"Error al cargar las categorias",text:t+" ("+e.t0.message+")"});case 11:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(){return l.apply(this,arguments)}),submitForm:(n=i(s.a.mark((function e(){var t,r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.submiting=!0,e.prev=1,t=new FormData,r=this,Object.keys(this.form).forEach((function(e){r.form[e]&&"details"!=e?t.append(e,r.form[e]):"details"==e&&_.forEach(r.form[e],(function(e,r){t.append("details["+r+"]",e)}))})),e.next=7,axios.post("/api/products",t,{headers:{"Content-Type":"multipart/form-data"}});case 7:console.log("Producto añadido"),this.$notify({group:"messages",type:"success",title:"Producto añadido exitosamente"}),this.$router.push({name:"categories"}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),e.t0.response?401==e.t0.response.status||403==e.t0.response.status?this.generalError="No posee acceso al recurso solicitado":_.extend(this.validationErrors,e.t0.response.data.errors):(a="",a=e.t0.request?"El servidor tardó en responder":"No se pudo comunicar con el servidor",this.generalError=a+" ("+e.t0.message+")");case 15:return e.prev=15,this.submiting=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))),function(){return n.apply(this,arguments)})}},u=r(1),d=Object(u.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"flex flex-1 flex-col sm:justify-center items-center sm:bg-orange-400"},[r("div",{staticClass:"bg-white sm:border sm:border-orange-500 sm:rounded-md sm:shadow-lg w-full max-w-full sm:max-w-sm lg:max-w-lg"},[r("h1",{staticClass:"bg-orange-500 text-white font-semibold text-3xl text-center p-4"},[e._v("Añadir producto")]),e._v(" "),r("div",{staticClass:"px-8 py-6"},[r("form",{staticClass:"space-y-6",on:{submit:function(t){return t.preventDefault(),e.submitForm(t)}}},[r("div",{staticClass:"space-y-2"},[r("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.form.name,expression:"form.name",modifiers:{trim:!0}}],staticClass:"w-full border-b border-orange-300 focus:border-orange-400 py-2 px-1 placeholder-gray-700 text-orange-500 transition duration-300 ease-in-out",attrs:{type:"text",maxlength:"100",placeholder:"Nombre"},domProps:{value:e.form.name},on:{input:function(t){t.target.composing||e.$set(e.form,"name",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),e._v(" "),e._l(e.validationErrors.name,(function(t,a){return r("p",{key:a,staticClass:"text-red-600"},[e._v(e._s(t))])}))],2),e._v(" "),r("div",{staticClass:"space-y-2"},[r("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.form.model,expression:"form.model",modifiers:{trim:!0}}],staticClass:"w-full border-b border-orange-300 focus:border-orange-400 py-2 px-1 placeholder-gray-700 text-orange-500 transition duration-300 ease-in-out",attrs:{type:"text",maxlength:"100",placeholder:"Modelo"},domProps:{value:e.form.model},on:{input:function(t){t.target.composing||e.$set(e.form,"model",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),e._v(" "),e._l(e.validationErrors.model,(function(t,a){return r("p",{key:a,staticClass:"text-red-600"},[e._v(e._s(t))])}))],2),e._v(" "),r("div",{staticClass:"space-y-2"},[r("input",{directives:[{name:"model",rawName:"v-model.number",value:e.form.price,expression:"form.price",modifiers:{number:!0}}],staticClass:"w-full border-b border-orange-300 focus:border-orange-400 py-2 px-1 placeholder-gray-700 text-orange-500 transition duration-300 ease-in-out",attrs:{type:"text",placeholder:"Precio"},domProps:{value:e.form.price},on:{keypress:function(t){return e.onlyNumbers(t)},input:function(t){t.target.composing||e.$set(e.form,"price",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),e._v(" "),e._l(e.validationErrors.price,(function(t,a){return r("p",{key:a,staticClass:"text-red-600"},[e._v(e._s(t))])}))],2),e._v(" "),r("div",{staticClass:"space-y-2"},[r("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.form.description,expression:"form.description",modifiers:{trim:!0}}],staticClass:"w-full border-b border-orange-300 focus:border-orange-400 py-2 px-1 placeholder-gray-700 text-orange-500 transition duration-300 ease-in-out",attrs:{placeholder:"Descripción"},domProps:{value:e.form.description},on:{input:function(t){t.target.composing||e.$set(e.form,"description",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),e._v(" "),e._l(e.validationErrors.description,(function(t,a){return r("p",{key:a,staticClass:"text-red-600"},[e._v(e._s(t))])}))],2),e._v(" "),r("div",{staticClass:"space-y-2"},[r("label",[r("span",{staticClass:"text-orange-500"},[e._v("Imágen:")]),e._v(" "),r("input",{ref:"thumbnail",attrs:{type:"file",accept:"image/*"},on:{change:function(t){e.form.thumbnail=t.target.files[0]}}})]),e._v(" "),e.form.thumbnail?r("div",{staticClass:"w-3/12 h-auto p-2"},[r("img",{staticClass:"border border-orange-600 rounded-md shadow-md",attrs:{src:e.getImage(e.form.thumbnail)}})]):e._e(),e._v(" "),e.form.thumbnail?r("button",{staticClass:"text-blue-500 hover:text-blue-600 focus:text-blue-600 text-sm",attrs:{type:"button"},on:{click:function(t){e.$refs.thumbnail.value="",e.form.thumbnail=null}}},[e._v("Borrar imágenes")]):e._e(),e._v(" "),e._l(e.validationErrors.thumbnail,(function(t,a){return r("p",{key:a,staticClass:"text-red-600"},[e._v(e._s(t))])}))],2),e._v(" "),r("div",{staticClass:"space-y-2"},[r("label",[r("span",{staticClass:"text-orange-500"},[e._v("Imágenes de detalle:")]),e._v(" "),r("input",{ref:"details",attrs:{type:"file",accept:"image/*",multiple:""},on:{change:function(t){return e.setDetailsImages(t.target.files)}}})]),e._v(" "),e.detailsC?r("div",{staticClass:"flex flex-row flex-wrap"},e._l(e.detailsC,(function(e,t){return r("div",{key:t,staticClass:"w-3/12 h-auto p-2"},[r("img",{staticClass:"border border-orange-600 rounded-md shadow-md",attrs:{src:e}})])})),0):e._e(),e._v(" "),e.form.details.length>0?r("button",{staticClass:"text-blue-500 hover:text-blue-600 focus:text-blue-600 text-sm",attrs:{type:"button"},on:{click:function(t){e.$refs.details.value="",e.form.details=[],e.detailsC=null}}},[e._v("Borrar imágenes")]):e._e(),e._v(" "),e._l(e.validationErrors.details,(function(t,a){return r("p",{key:a,staticClass:"text-red-600"},[e._v(e._s(t))])}))],2),e._v(" "),r("div",{staticClass:"space-y-2"},[r("label",[r("span",{staticClass:"text-orange-500"},[e._v("Categoría:")]),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.form.category,expression:"form.category"}],staticClass:"text-gray-800",on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.form,"category",t.target.multiple?r:r[0])}}},[r("option",{attrs:{disabled:"",value:""}},[e._v("Seleccione alguna categoría")]),e._v(" "),e._l(e.categories,(function(t,a){return r("option",{key:a,domProps:{value:t.id}},[e._v("\n                                "+e._s(t.name)+"\n                            ")])}))],2)]),e._v(" "),e._l(e.validationErrors.category,(function(t,a){return r("p",{key:a,staticClass:"text-red-600"},[e._v(e._s(t))])}))],2),e._v(" "),e.generalError?r("p",{staticClass:"text-red-600"},[e._v(e._s(e.generalError))]):e._e(),e._v(" "),r("button",{staticClass:"w-full btn-outlined btn-outlined-orange font-semibold text-center px-3 py-2",attrs:{disabled:e.submiting,type:"submit"}},[e.submiting?[r("span",{staticClass:"spinner spinner-disabled w-6 h-6 mx-2"})]:[e._v("\n                        Crear producto\n                    ")]],2)])])])])}),[],!1,null,null,null);t.default=d.exports}}]);
//# sourceMappingURL=9.js.map